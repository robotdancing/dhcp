# dhcpd.office-149-20.conf file for office-net DHCP pools served by the
# 950 Charter #failover peerset. This file may be copied to /etc between
# these two systems without modifications.
#

# APC powerrack systems need tender care and loving molestation to behave
# appropriately by default.
option space APC;
option APC.cookie code 1 = string;

option APC.cookie "1APC";

class "APC" {
	match if substring(option vendor-class-identifier, 0, 3) = "APC";

	vendor-option-space APC;
}

# This option is in the site-local space, but it is a de-facto standard
# today.
option wpad code 252 = text;

# The least potentially damaging empty value to hopefully convince clients not
# to engage in DNS.
option wpad "\n\000";

class "MSFT" {
	match if substring(option vendor-class-identifier, 0, 4) = "MSFT";

	# Windows doesn't put WPAD on its PRL, but does consume it.
	option dhcp-parameter-request-list =
			concat(option dhcp-parameter-request-list, fc);
}


# Local PXE support.  For now we only boot SUSE.
option space PXE;
option PXE.mtftp-ip		code 1 = ip-address;
option PXE.mtftp-oport		code 2 = unsigned integer 16;
option PXE.mtftp-sport		code 3 = unsigned integer 16;
option PXE.mtftp-tmout		code 4 = unsigned integer 8;
option PXE.mtftp-delay		code 5 = unsigned integer 8;
option PXE.discovery-control	code 6 = unsigned integer 8;
option PXE.discovery-mcast-addr	code 7 = unsigned integer 8;
	
# These are 'site local' options the PXELinux bootloader uses.
option space pxelinux;
option pxelinux.magic		code 208 = string;
option pxelinux.configfile	code 209 = text;
option pxelinux.pathprefix	code 210 = text;
option pxelinux.reboottime	code 211 = unsigned integer 32;

class "pxeclients" {
	match if substring (option vendor-class-identifier, 0, 9) = "PXEClient";
	# Some PXE clients are said to require that the vci be sent.
	# But it seems clear that if we send these PXE and vendor-class
	# options, it also expects "extended DHCP" via port 4011.  For
	# PXE versions 2 and onwards.
	option vendor-class-identifier "PXEClient";
	vendor-option-space PXE;

	ddns-updates off;

	# Some PXE clients refuse to tftp if mtftp fails.  Others take
	# longer.
	option PXE.mtftp-ip 0.0.0.0;
	filename "pxelinux.0";
	next-server 204.152.187.81;

	site-option-space "pxelinux";
	# PXE does not request site-local options.
	if exists dhcp-parameter-request-list {
		option dhcp-parameter-request-list = concat(option dhcp-parameter-request-list,d0,d1,d2,d3);
	}
	option pxelinux.reboottime 30;
}

subnet 149.20.50.0 netmask 255.255.255.128 {
	option subnet-mask 255.255.255.128;
	option routers 149.20.50.1;
	option broadcast-address 149.20.50.127;

	ddns-updates off;

	pool {
		#failover peer "isc";
		deny dynamic bootp clients;
		range 149.20.50.33 149.20.50.120;
#	future expansion
#		range 149.20.50.x 149.20.50.y;
	}
}

#; 149.20.50.0/25 - SQL1 Office Desktop Machines
#0       IN      PTR     sql1-office.sql1.isc.org.
#                A       255.255.255.128
#1       IN      PTR     exit.sql1-office.sql1.isc.org.
#2       IN      PTR     sql1-office.f1.sql1.isc.org.
#3       IN      PTR     sql1-office.f2.sql1.isc.org.
#
#; Leave 4-19 free for static allocations.
#
#$GENERATE 20-120 $ PTR dhcp-$.sql1.isc.org.
#
#127     IN      PTR     bcast.sql1-office.sql1.isc.org.


#class "smart-clients" {
#  match if substring (hardware, 1, 3) = 00:10:4b;
#  option domain-name-servers 127.0.0.1;
#}

